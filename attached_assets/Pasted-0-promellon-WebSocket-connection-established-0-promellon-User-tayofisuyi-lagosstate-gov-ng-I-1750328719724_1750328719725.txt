0|promellon  | WebSocket connection established
0|promellon  | User tayofisuyi@lagosstate.gov.ng (ID: 15) authenticated on WebSocket
0|promellon  | Storage: Creating notification with data: {"userId":4,"title":"New direct message","message":"Tayo Fisuyi sent you a message: \"Oka\"","type":"direct_message","referenceId":74,"referenceType":"direct_message","isRead":false}
0|promellon  | Storage: Failed to create notification: error: null value in column "userId" of relation "notifications" violates not-null constraint
0|promellon  |     at /root/DataInsightScraper/node_modules/pg-pool/index.js:45:11
0|promellon  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|promellon  |     at <anonymous> (/root/DataInsightScraper/node_modules/src/node-postgres/session.ts:104:19)
0|promellon  |     at Object.createNotification (/root/DataInsightScraper/server/storage.ts:1176:33)
0|promellon  |     at <anonymous> (/root/DataInsightScraper/server/routes.ts:5648:9) {
0|promellon  |   length: 359,
0|promellon  |   severity: 'ERROR',
0|promellon  |   code: '23502',
0|promellon  |   detail: 'Failing row contains (138, 4, New direct message, Tayo Fisuyi sent you a message: "Oka", direct_message, 74, direct_message, f, 2025-06-19 10:24:57.016677, null, f, null, null).',
0|promellon  |   hint: undefined,
0|promellon  |   position: undefined,
0|promellon  |   internalPosition: undefined,
0|promellon  |   internalQuery: undefined,
0|promellon  |   where: undefined,
0|promellon  |   schema: 'public',
0|promellon  |   table: 'notifications',
0|promellon  |   column: 'userId',
0|promellon  |   dataType: undefined,
0|promellon  |   constraint: undefined,
0|promellon  |   file: 'execMain.c',
0|promellon  |   line: '1982',
0|promellon  |   routine: 'ExecConstraints'
0|promellon  | }
0|promellon  | Storage: Database constraint violation - userId mapping issue
0|promellon  | Storage: Input data was: {"userId":4,"title":"New direct message","message":"Tayo Fisuyi sent you a message: \"Oka\"","type":"direct_message","referenceId":74,"referenceType":"direct_message","isRead":false}
0|promellon  | Storage: Attempting fallback SQL insert for notification
0|promellon  | Storage: Fallback notification creation also failed: error: null value in column "userId" of relation "notifications" violates not-null constraint
0|promellon  |     at /root/DataInsightScraper/node_modules/pg-pool/index.js:45:11
0|promellon  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|promellon  |     at Object.createNotification (/root/DataInsightScraper/server/storage.ts:1193:26)
0|promellon  |     at <anonymous> (/root/DataInsightScraper/server/routes.ts:5648:9) {
0|promellon  |   length: 359,
0|promellon  |   severity: 'ERROR',
0|promellon  |   code: '23502',
0|promellon  |   detail: 'Failing row contains (139, 4, New direct message, Tayo Fisuyi sent you a message: "Oka", direct_message, 74, direct_message, f, 2025-06-19 10:24:57.052121, null, f, null, null).',
0|promellon  |   hint: undefined,
0|promellon  |   position: undefined,
0|promellon  |   internalPosition: undefined,
0|promellon  |   internalQuery: undefined,
0|promellon  |   where: undefined,
0|promellon  |   schema: 'public',
0|promellon  |   table: 'notifications',
0|promellon  |   column: 'userId',
0|promellon  |   dataType: undefined,
0|promellon  |   constraint: undefined,
0|promellon  |   file: 'execMain.c',
0|promellon  |   line: '1982',
0|promellon  |   routine: 'ExecConstraints'
0|promellon  | }
0|promellon  | Broadcasting real-time message via HTTP route: 74
0|promellon  | Sent new message notification to receiver: 4
0|promellon  | Sent confirmation to sender: 15
0|promellon  | Sent new message notification to receiver: 4
